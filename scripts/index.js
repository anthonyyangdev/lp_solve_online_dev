const dev=!1,LP_SOLVE_API="https://peaceful-zion-91234.herokuapp.com/";$(document).ready(()=>{function b(a){$(m.main.LOG).val(`${$(m.main.LOG).val()}${a}\n`)}function c(a){$(m.main.TEXTSPACE).val($(a).val())}function d(a){$(a).val($(m.main.TEXTSPACE).val())}function f(a){o.current=a}function g(a){return $(a).val()}function h(a){return a===o.current}function i(a){const b=$(a.target);return`#${b[0].id}`}function j(c){var d=document.createElement("a");for(var a in c){var e=new Blob([c[a]],{type:"text/plain"});d.href=URL.createObjectURL(e),d.download=a,document.body.appendChild(d),d.click(),b(`${a} Downloaded...\n`)}setTimeout(function(){document.body.removeChild(d)},0)}function k(){let a=document.createElement("tr"),b="<td>Constraint</td>";for(var c=0;c<o["variable-count"];c++)b+="<td><input type=\"number\" class=\"matrix-input\"></td>";return a.innerHTML=b+n,a}function l(a){var b=a?$(m.matrix.MATRIX_CONFIG).show():$(m.matrix.MATRIX_CONFIG).hide(),b=a?$(m.main.TEXTSPACE).hide():$(m.main.TEXTSPACE).show()}const m={main:{SOURCE:"#source",MATRIX:"#matrix",OPTIONS:"#options",RESULT:"#result",DOWNLOAD:"#download",UPLOAD:"#upload",RUN:"#run",TEXTSPACE:"#textspace",LOG:"#log",HELP:"#help"},matrix:{MATRIX_CONFIG:"#matrix-config",LP_MATRIX:"#lp-matrix",VAR_COUNT:"#variable-count",CONSTRAINT_COUNT:"#constraint-count",MATRIX_BODY:"#matrix-body",RESET:"#reset-button",OPTIMAL_GOAL:"#optimal-goal",TARGET_GOAL_VALUE:"#target-goal-value",PARSE_MATRIX:"#parse-matrix",VARIABLE_NAMES:"#variable-names",OBJECTIVE_FUNCTION:"#objective-function"},result:{RESULT_DASH:"#result-dash",DOWNLOAD_REPORT:"#download-report",OBJECTIVE:"#objective-button",CONSTRAINTS:"#constraints-button",SENSITIVITY:"#sensitivity-button"},class:{RESULT_TABS:".result-tab",TAB_BUTTONS:".tab-button",CONSTRAINT_EQ:".constraint-equations",COUNTER_MOD:".counter-mod",MATRIX_INPUT:".matrix-input"}},n="<td><select><option> <= </option><option> >= </option><option> = </option><option> > </option><option> < </option></select></td><td><input type=\"number\"/></td>";let o={current:m.main.SOURCE,"constraint-count":parseInt($(m.matrix.CONSTRAINT_COUNT).val()),"variable-count":parseInt($(m.matrix.VAR_COUNT).val())};$(m.main.UPLOAD).click(()=>{var a=document.createElement("input");a.type="file",document.body.appendChild(a),a.onchange=c=>{var d=c.target.files[0],e=d.name,f=new FileReader;f.readAsText(d,"UTF-8"),f.onload=a=>{var c=a.target.result;$(m.main.SOURCE).val(c),o.current===m.main.SOURCE&&$(m.main.TEXTSPACE).val(c),b(`Content from ${e} is placed into source text space.\n`)},document.body.removeChild(a)},a.click()}),$(m.result.DOWNLOAD_REPORT).click(()=>{j({"report.txt":g(m.result.DOWNLOAD_REPORT)})}),$(m.main.DOWNLOAD).click(()=>{h(m.main.SOURCE)&&d(m.main.SOURCE),j({"lp_solve.txt":g(m.main.SOURCE)})}),$(m.main.HELP).click(()=>{alert("Help:\n\nClick on the [Source] button and write your algebraic model in the text space below.\nThe syntax follows the same convention as that for the original lp_solve program.\n\nWhen done, press the [Run] button for the model to be solved. The bottom of the screen will display [Running Complete.] if successful.\n\nThe results/answers are displayed in the [Results] section (Press the [Result] button to see.)\n\nSince this is currently being built and tested, it is recommended that you check with the actual lp_solve program or a spreadsheet model to decide on the optimal solution.")}),$(m.class.COUNTER_MOD).change(function(){const a=$(this).val(),b=$(this)[0].id;var c=`#${b}`===m.matrix.CONSTRAINT_COUNT?0:1;if(!(a<c)){const c=a-o[b];o[b]=parseInt(a),operation={"incr-variable-count":()=>{children=$(m.matrix.MATRIX_BODY)[0].children;for(var a of children){const b=document.createElement("td");b.innerHTML="<input type=\"text\" class=\"matrix-input\"/>",$(a)[0].insertBefore(b,$(a)[0].childNodes[1])}},"decr-variable-count":()=>{children=$(m.matrix.MATRIX_BODY)[0].children;for(var a of children){const b=$(a)[0].childNodes[1];$(a)[0].removeChild(b)}},"incr-constraint-count":()=>{const a=k();$(m.matrix.MATRIX_BODY)[0].appendChild(a)},"decr-constraint-count":()=>{const a=$(m.matrix.MATRIX_BODY)[0].lastChild;$(m.matrix.MATRIX_BODY)[0].removeChild(a)}},performOperation=0<c?operation[`incr-${b}`]:operation[`decr-${b}`];for(var d=0;d<Math.abs(c);d++)performOperation()}}),$(m.matrix.RESET).click(function(){$(m.class.MATRIX_INPUT).val("")}),$(m.matrix.OPTIMAL_GOAL).change(()=>{"toValue"===$(m.matrix.OPTIMAL_GOAL).val()?$(m.matrix.TARGET_GOAL_VALUE).show():$(m.matrix.TARGET_GOAL_VALUE).hide()}),$(m.matrix.PARSE_MATRIX).click(function(){for(var a=$(m.matrix.VARIABLE_NAMES)[0].children,b=$(m.matrix.OBJECTIVE_FUNCTION)[0].children,c=$(m.matrix.MATRIX_BODY)[0].children,d={objective:"",constraints:[]},e=1;e<a.length;e++){var f=$(b[e]).children().first().val(),g=$(a[e]).children().first().val();if(""==g)return void alert(`A name is not given for variable ${e}`);""==f&&(f=0),d.objective+=`${f}${g}`,d.objective+=e==a.length-1?";":"+"}for(var g,e=1;e<a.length+2;e++){g=e<a.length?$(a[e]).children().first().val():"";for(var h=2;h<o["constraint-count"]+2;h++){let b=$($(c[h]).children()[e]).children().first().val();""==b&&(b=0),d.constraints[h-2]=1==e?"":d.constraints[h-2],d.constraints[h-2]+=`${b}${g}`,d.constraints[h-2]+=e<a.length-1?"+":e<a.length+1?"":";"}}d.objective=`${$(m.matrix.OPTIMAL_GOAL).val()}: ${d.objective}`,$(m.main.SOURCE).val(d.objective);for(var k of d.constraints){const a=$(m.main.SOURCE).val();$(m.main.SOURCE).val(`${a}\n${k}`)}alert("Your matrix has been parsed into algebraic statements in `SOURCE`")}),$(m.main.RUN).click(()=>{h(m.main.SOURCE)&&d(m.main.SOURCE);var a={content:g(m.main.SOURCE)};b("Now Running..."),fetch(LP_SOLVE_API,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(a)}).then(a=>a.json()).then(a=>{console.log(a);const d=a.result.solution;b("Running Complete.\n"),$(m.result.DOWNLOAD_REPORT).val(a.result.solution),$(m.result.OBJECTIVE).val(d),c(o.current)}).catch(function(){b("Unable to connect to the server...")})}),$(m.class.TAB_BUTTONS).click(a=>(d(o.current),f(i(a)),h(m.main.RESULT)?($(m.result.RESULT_DASH).show(),f(m.result.OBJECTIVE)):$(m.result.RESULT_DASH).hide(),h(m.main.MATRIX))?void l(!0):void(l(!1),c(o.current),$(m.main.TEXTSPACE).attr("readonly",!h(m.main.SOURCE)),console.log("Assertion",!h(m.main.RESULT)))),$(m.class.RESULT_TABS).click(a=>{var b=i(a);d(o.current),f(b),c(o.current)})});