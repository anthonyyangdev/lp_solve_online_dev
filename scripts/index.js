const dev=!1,LP_SOLVE_API=dev?"http://localhost:5000/":"https://peaceful-zion-91234.herokuapp.com/";$(document).ready(()=>{function t(){const t=m.main.LOG.slice(1),e=document.getElementById(t);e.scrollTop=e.scrollHeight}function e(e){$(m.main.LOG).val(`${$(m.main.LOG).val()}${e}\n`),t()}function n(t){$(m.main.TEXTSPACE).val($(t).val())}function r(t){$(t).val($(m.main.TEXTSPACE).val())}function o(t){T.current=t}function i(t){return $(t).val()}function a(t){return t===T.current}function c(t){const e=$(t.target);return`#${e[0].id}`}function l(t){var n=document.createElement("a");for(var r in t){var o=new Blob([t[r]],{type:"text/plain"});n.href=URL.createObjectURL(o),n.download=r,document.body.appendChild(n),n.click(),e(`${r} Downloaded...\n`)}setTimeout(function(){document.body.removeChild(n)},0)}function s(){let t=document.createElement("tr"),e="<td>Constraint</td>";for(var n=0;n<T["variable-count"];n++)e+='<td><input type="number" class="matrix-input"></td>';return t.innerHTML=e+d,t}function u(t){t?$(m.matrix.MATRIX_CONFIG).show():$(m.matrix.MATRIX_CONFIG).hide(),t?$(m.main.TEXTSPACE).hide():$(m.main.TEXTSPACE).show()}const m={main:{SOURCE:"#source",MATRIX:"#matrix",OPTIONS:"#options",RESULT:"#result",DOWNLOAD:"#download",UPLOAD:"#upload",RUN:"#run",TEXTSPACE:"#textspace",LOG:"#log",HELP:"#help"},matrix:{MATRIX_CONFIG:"#matrix-config",LP_MATRIX:"#lp-matrix",VAR_COUNT:"#variable-count",CONSTRAINT_COUNT:"#constraint-count",MATRIX_BODY:"#matrix-body",RESET:"#reset-button",OPTIMAL_GOAL:"#optimal-goal",TARGET_GOAL_VALUE:"#target-goal-value",PARSE_MATRIX:"#parse-matrix",VARIABLE_NAMES:"#variable-names",OBJECTIVE_FUNCTION:"#objective-function"},result:{RESULT_DASH:"#result-dash",DOWNLOAD_REPORT:"#download-report",OBJECTIVE:"#objective-button",CONSTRAINTS:"#constraints-button",SENSITIVITY:"#sensitivity-button"},class:{RESULT_TABS:".result-tab",TAB_BUTTONS:".tab-button",CONSTRAINT_EQ:".constraint-equations",COUNTER_MOD:".counter-mod",MATRIX_INPUT:".matrix-input"}},d='<td><select><option> <= </option><option> >= </option><option> = </option><option> > </option><option> < </option></select></td><td><input type="number"/></td>',T={current:m.main.SOURCE,"constraint-count":parseInt($(m.matrix.CONSTRAINT_COUNT).val()),"variable-count":parseInt($(m.matrix.VAR_COUNT).val())};$(m.main.UPLOAD).click(()=>{var t=document.createElement("input");t.type="file",document.body.appendChild(t),t.onchange=(n=>{var r=n.target.files[0],o=r.name,i=new FileReader;i.readAsText(r,"UTF-8"),i.onload=(t=>{var n=t.target.result;$(m.main.SOURCE).val(n),T.current===m.main.SOURCE&&$(m.main.TEXTSPACE).val(n),e(`Content from ${o} is placed into source text space.\n`)}),document.body.removeChild(t)}),t.click()}),$(m.result.DOWNLOAD_REPORT).click(()=>{l({"report.txt":i(m.result.DOWNLOAD_REPORT)})}),$(m.main.DOWNLOAD).click(()=>{a(m.main.SOURCE)&&r(m.main.SOURCE),l({"lp_solve.txt":i(m.main.SOURCE)})}),$(m.main.HELP).click(()=>{const t="Help:\n\nClick on the [Source] button and write your algebraic model in the text space below.\nThe syntax follows the same convention as that for the original lp_solve program.\n\nWhen done, press the [Run] button for the model to be solved. The bottom of the screen will display [Running Complete.] if successful.\n\nThe results/answers are displayed in the [Results] section (Press the [Result] button to see.)\n\nSince this is currently being built and tested, it is recommended that you check with the actual lp_solve program or a spreadsheet model to decide on the optimal solution.";alert(t)}),$(m.class.COUNTER_MOD).change(function(t){const e=$(this).val(),n=$(this)[0].id;var r=`#${n}`===m.matrix.CONSTRAINT_COUNT?0:1;if(e<r)return;const o=e-T[n];T[n]=parseInt(e),operation={"incr-variable-count":()=>{for(var t of(children=$(m.matrix.MATRIX_BODY)[0].children,children)){const e=document.createElement("td");e.innerHTML='<input type="text" class="matrix-input"/>',$(t)[0].insertBefore(e,$(t)[0].childNodes[1])}},"decr-variable-count":()=>{for(var t of(children=$(m.matrix.MATRIX_BODY)[0].children,children)){const e=$(t)[0].childNodes[1];$(t)[0].removeChild(e)}},"incr-constraint-count":()=>{const t=s();$(m.matrix.MATRIX_BODY)[0].appendChild(t)},"decr-constraint-count":()=>{const t=$(m.matrix.MATRIX_BODY)[0].lastChild;$(m.matrix.MATRIX_BODY)[0].removeChild(t)}},performOperation=o>0?operation[`incr-${n}`]:operation[`decr-${n}`];for(var i=0;i<Math.abs(o);i++)performOperation()}),$(m.matrix.RESET).click(function(){$(m.class.MATRIX_INPUT).val("")}),$(m.matrix.OPTIMAL_GOAL).change(()=>{"toValue"===$(m.matrix.OPTIMAL_GOAL).val()?$(m.matrix.TARGET_GOAL_VALUE).show():$(m.matrix.TARGET_GOAL_VALUE).hide()}),$(m.matrix.PARSE_MATRIX).click(function(){for(var t=$(m.matrix.VARIABLE_NAMES)[0].children,e=$(m.matrix.OBJECTIVE_FUNCTION)[0].children,n=$(m.matrix.MATRIX_BODY)[0].children,r={objective:"",constraints:[]},o=1;o<t.length;o++){var i=$(e[o]).children().first().val(),a=$(t[o]).children().first().val();if(""==a)return void alert(`A name is not given for variable ${o}`);""==i&&(i=0),r.objective+=`${i}${a}`,r.objective+=o===t.length-1?";":"+"}for(o=1;o<t.length+2;o++){a=o<t.length?$(t[o]).children().first().val():"";for(var c=2;c<T["constraint-count"]+2;c++){let e=$($(n[c]).children()[o]).children().first().val();""==e&&(e=0),r.constraints[c-2]=1===o?"":r.constraints[c-2],r.constraints[c-2]+=`${e}${a}`,r.constraints[c-2]+=o<t.length-1?"+":o<t.length+1?"":";"}}for(var l of(r.objective=`${$(m.matrix.OPTIMAL_GOAL).val()}: ${r.objective}`,$(m.main.SOURCE).val(r.objective),r.constraints)){const t=$(m.main.SOURCE).val();$(m.main.SOURCE).val(`${t}\n${l}`)}alert("Your matrix has been parsed into algebraic statements in `SOURCE`")}),$(m.main.RUN).click(()=>{a(m.main.SOURCE)&&r(m.main.SOURCE);var t={content:i(m.main.SOURCE)};e("Now Running..."),fetch(LP_SOLVE_API,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrer:"no-referrer",body:JSON.stringify(t)}).then(t=>t.json()).then(t=>{t.error&&(console.log(t.error),alert(t.error.msg));const r=t.result.solution;e("Running Complete.\n"),alert("Running Complete. Click [Result] for answers"),$(m.result.DOWNLOAD_REPORT).val(t.result.solution),$(m.result.OBJECTIVE).val(r),n(T.current)}).catch(function(t){e("Unable to connect to the server...")})}),$(m.class.TAB_BUTTONS).click(t=>{r(T.current),o(c(t)),a(m.main.RESULT)?($(m.result.RESULT_DASH).show(),o(m.result.OBJECTIVE)):$(m.result.RESULT_DASH).hide(),a(m.main.MATRIX)?u(!0):(u(!1),n(T.current),$(m.main.TEXTSPACE).attr("readonly",!a(m.main.SOURCE)),console.log("Assertion",!a(m.main.RESULT)))}),$(m.class.RESULT_TABS).click(t=>{var e=c(t);r(T.current),o(e),n(T.current)})});